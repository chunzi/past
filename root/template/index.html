<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Past</title>
    <link rel="stylesheet" href="/static/style.css" type="text/css" media="screen" charset="utf-8"/>
    <script type="text/javascript" src="/static/javascript/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="/static/javascript/jquery.autogrow.js"></script>
    <script type="text/javascript" src="/static/javascript/jquery.hotkeys-0.7.9.js"></script>
    <script type="text/javascript" src="/static/javascript/jquery.editinplace.packed.js"></script>
    <script>
    var $j = jQuery.noConflict();
    $j(document).ready( function(){
        $j('textarea.autogrow').autogrow();

        $j(document).bind('keydown', 'j', function(){
            if ( ! cur_thing ){
                cur_thing = 0;
                $j('#thing_'+things[cur_thing]).addClass('cur');
            }
            
        });
        $j(document).bind('keyup', { combi: 'i', disableInInput:true }, function(){
            $j('#new textarea').val('');
            $j('#new').show();
            $j('#new textarea').focus();
        });
        $j(document).bind('keyup', 'esc', function(){
            $j('#new textarea').blur();
            $j('#new').hide();
        });

        $j('#new textarea').bind('keydown', 'cmd+return', function(){ 
            $j.post(
                '/new',
                { thing: $j('#new textarea').val() },
                function(data){
                    $j('ul.things li.thing:last').after(data);
                    $j('#new textarea').blur();
                    $j('#new').hide();
                }
            );
        });


    });
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="header"><h1><a href="/">Past</a></h1></div>
        <div id='content'>

<div class="box">
<ul class="things">
    <li class="header">[% date.format( today.day, "%A, %e %b %Y") %]</li>
    [% FOREACH thing = today.things %]
        [% INCLUDE thing.html %]
    [% END %]
    <li class="footer">[% today.things.size %] things</li>
</ul>
</div>

<div id="new" class="box hide">
    <textarea class="autogrow"></textarea>
</div>

        </div>
        <div id="footer"></div>
    </div>
</body>
</html>
